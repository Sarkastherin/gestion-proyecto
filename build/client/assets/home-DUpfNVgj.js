import{g as we,j as R,w as ve,r as ue,u as xe}from"./chunk-PVWAREVJ-Cl_c9Jt0.js";import{u as Ee}from"./DataContext-B4mtDhe5.js";import{E as Re}from"./EntityTable-CYBYbV-K.js";import"./Buttons-dijALP0_.js";import{s as Ce}from"./supabaseClient-O5NoNd5h.js";import{C as Se}from"./Containers-ZXGJ7diH.js";import{M as Oe}from"./ModalBase-CQji_mgJ.js";import{P as Ie}from"./ProtectedRoute-DTKDj7Jz.js";import{g as Ae}from"./allowedRoles-DvcEYYJr.js";import{L as De}from"./LoaderComponent-DzoOhiNN.js";import{B as je}from"./box-BumqmFUH.js";var he={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Le=he.exports,be;function Te(){return be||(be=1,(function(S,q){((W,_)=>{S.exports=_()})(Le,function W(){var _=typeof self<"u"?self:typeof window<"u"?window:_!==void 0?_:{},j,F=!_.document&&!!_.postMessage,K=_.IS_PAPA_WORKER||!1,N={},Y=0,a={};function J(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=ce(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new pe(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var n=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<n){let d=this._config.newline;d||(i=this._config.quoteChar||'"',d=this._handle.guessLineEndings(t,i)),t=[...t.split(d).slice(n)].join(d)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var n=this._partialLine+t,i=(this._partialLine="",this._handle.parse(n,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,n=(this._finished||(this._partialLine=n.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),K)_.postMessage({results:i,workerId:a.WORKER_ID,finished:n});else if(b(this._config.chunk)&&!r){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!n||!b(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),n||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){b(this._config.error)?this._config.error(t):K&&this._config.error&&_.postMessage({workerId:a.WORKER_ID,error:t,finished:!1})}}function ae(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),J.call(this,e),this._nextChunk=F?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),F||(t.onload=X(this._chunkLoaded,this),t.onerror=X(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!F),this._config.downloadRequestHeaders){var r,n=this._config.downloadRequestHeaders;for(r in n)t.setRequestHeader(r,n[r])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(d){this._chunkError(d.message)}F&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function oe(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),J.call(this,e);var t,r,n=typeof FileReader<"u";this.stream=function(i){this._input=i,r=i.slice||i.webkitSlice||i.mozSlice,n?((t=new FileReader).onload=X(this._chunkLoaded,this),t.onerror=X(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,d=(this._config.chunkSize&&(d=Math.min(this._start+this._config.chunkSize,this._input.size),i=r.call(i,this._start,d)),t.readAsText(i,this._config.encoding));n||this._chunkLoaded({target:{result:d}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function re(e){var t;J.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,n;if(!this._finished)return r=this._config.chunkSize,t=r?(n=t.substring(0,r),t.substring(r)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function le(e){J.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){J.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){J.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=X(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(d){this._streamError(d)}},this),this._streamError=X(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=X(function(){this._streamCleanUp(),n=!0,this._streamData("")},this),this._streamCleanUp=X(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function pe(e){var t,r,n,i,d=Math.pow(2,53),O=-d,P=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,U=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,v=0,o=0,T=!1,u=!1,f=[],s={data:[],errors:[],meta:{}};function I(p){return e.skipEmptyLines==="greedy"?p.join("").trim()==="":p.length===1&&p[0].length===0}function C(){if(s&&n&&(B("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(s.data=s.data.filter(function(l){return!I(l)})),L()){let l=function(E,A){b(e.transformHeader)&&(E=e.transformHeader(E,A)),f.push(E)};if(s)if(Array.isArray(s.data[0])){for(var p=0;L()&&p<s.data.length;p++)s.data[p].forEach(l);s.data.splice(0,1)}else s.data.forEach(l)}function m(l,E){for(var A=e.header?{}:[],y=0;y<l.length;y++){var k=y,g=l[y],g=((H,h)=>(w=>(e.dynamicTypingFunction&&e.dynamicTyping[w]===void 0&&(e.dynamicTyping[w]=e.dynamicTypingFunction(w)),(e.dynamicTyping[w]||e.dynamicTyping)===!0))(H)?h==="true"||h==="TRUE"||h!=="false"&&h!=="FALSE"&&((w=>{if(P.test(w)&&(w=parseFloat(w),O<w&&w<d))return 1})(h)?parseFloat(h):U.test(h)?new Date(h):h===""?null:h):h)(k=e.header?y>=f.length?"__parsed_extra":f[y]:k,g=e.transform?e.transform(g,k):g);k==="__parsed_extra"?(A[k]=A[k]||[],A[k].push(g)):A[k]=g}return e.header&&(y>f.length?B("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+y,o+E):y<f.length&&B("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+y,o+E)),A}var x;s&&(e.header||e.dynamicTyping||e.transform)&&(x=1,!s.data.length||Array.isArray(s.data[0])?(s.data=s.data.map(m),x=s.data.length):s.data=m(s.data,0),e.header&&s.meta&&(s.meta.fields=f),o+=x)}function L(){return e.header&&f.length===0}function B(p,m,x,l){p={type:p,code:m,message:x},l!==void 0&&(p.row=l),s.errors.push(p)}b(e.step)&&(i=e.step,e.step=function(p){s=p,L()?C():(C(),s.data.length!==0&&(v+=p.data.length,e.preview&&v>e.preview?r.abort():(s.data=s.data[0],i(s,c))))}),this.parse=function(p,m,x){var l=e.quoteChar||'"',l=(e.newline||(e.newline=this.guessLineEndings(p,l)),n=!1,e.delimiter?b(e.delimiter)&&(e.delimiter=e.delimiter(p),s.meta.delimiter=e.delimiter):((l=((E,A,y,k,g)=>{var H,h,w,V;g=g||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var ee=0;ee<g.length;ee++){for(var Q,ne=g[ee],z=0,$=0,D=0,M=(w=void 0,new de({comments:k,delimiter:ne,newline:A,preview:10}).parse(E)),Z=0;Z<M.data.length;Z++)y&&I(M.data[Z])?D++:(Q=M.data[Z].length,$+=Q,w===void 0?w=Q:0<Q&&(z+=Math.abs(Q-w),w=Q));0<M.data.length&&($/=M.data.length-D),(h===void 0||z<=h)&&(V===void 0||V<$)&&1.99<$&&(h=z,H=ne,V=$)}return{successful:!!(e.delimiter=H),bestDelimiter:H}})(p,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(n=!0,e.delimiter=a.DefaultDelimiter),s.meta.delimiter=e.delimiter),ce(e));return e.preview&&e.header&&l.preview++,t=p,r=new de(l),s=r.parse(t,m,x),C(),T?{meta:{paused:!0}}:s||{meta:{paused:!1}}},this.paused=function(){return T},this.pause=function(){T=!0,r.abort(),t=b(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){c.streamer._halted?(T=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return u},this.abort=function(){u=!0,r.abort(),s.meta.aborted=!0,b(e.complete)&&e.complete(s),t=""},this.guessLineEndings=function(E,l){E=E.substring(0,1048576);var l=new RegExp(ie(l)+"([^]*?)"+ie(l),"gm"),x=(E=E.replace(l,"")).split("\r"),l=E.split(`
`),E=1<l.length&&l[0].length<x[0].length;if(x.length===1||E)return`
`;for(var A=0,y=0;y<x.length;y++)x[y][0]===`
`&&A++;return A>=x.length/2?`\r
`:"\r"}}function ie(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function de(e){var t=(e=e||{}).delimiter,r=e.newline,n=e.comments,i=e.step,d=e.preview,O=e.fastMode,P=null,U=!1,c=e.quoteChar==null?'"':e.quoteChar,v=c;if(e.escapeChar!==void 0&&(v=e.escapeChar),(typeof t!="string"||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),n===t)throw new Error("Comment character same as delimiter");n===!0?n="#":(typeof n!="string"||-1<a.BAD_DELIMITERS.indexOf(n))&&(n=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var o=0,T=!1;this.parse=function(u,f,s){if(typeof u!="string")throw new Error("Input must be a string");var I=u.length,C=t.length,L=r.length,B=n.length,p=b(i),m=[],x=[],l=[],E=o=0;if(!u)return z();if(O||O!==!1&&u.indexOf(c)===-1){for(var A=u.split(r),y=0;y<A.length;y++){if(l=A[y],o+=l.length,y!==A.length-1)o+=r.length;else if(s)return z();if(!n||l.substring(0,B)!==n){if(p){if(m=[],V(l.split(t)),$(),T)return z()}else V(l.split(t));if(d&&d<=y)return m=m.slice(0,d),z(!0)}}return z()}for(var k=u.indexOf(t,o),g=u.indexOf(r,o),H=new RegExp(ie(v)+ie(c),"g"),h=u.indexOf(c,o);;)if(u[o]===c)for(h=o,o++;;){if((h=u.indexOf(c,h+1))===-1)return s||x.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:m.length,index:o}),Q();if(h===I-1)return Q(u.substring(o,h).replace(H,c));if(c===v&&u[h+1]===v)h++;else if(c===v||h===0||u[h-1]!==v){k!==-1&&k<h+1&&(k=u.indexOf(t,h+1));var w=ee((g=g!==-1&&g<h+1?u.indexOf(r,h+1):g)===-1?k:Math.min(k,g));if(u.substr(h+1+w,C)===t){l.push(u.substring(o,h).replace(H,c)),u[o=h+1+w+C]!==c&&(h=u.indexOf(c,o)),k=u.indexOf(t,o),g=u.indexOf(r,o);break}if(w=ee(g),u.substring(h+1+w,h+1+w+L)===r){if(l.push(u.substring(o,h).replace(H,c)),ne(h+1+w+L),k=u.indexOf(t,o),h=u.indexOf(c,o),p&&($(),T))return z();if(d&&m.length>=d)return z(!0);break}x.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:m.length,index:o}),h++}}else if(n&&l.length===0&&u.substring(o,o+B)===n){if(g===-1)return z();o=g+L,g=u.indexOf(r,o),k=u.indexOf(t,o)}else if(k!==-1&&(k<g||g===-1))l.push(u.substring(o,k)),o=k+C,k=u.indexOf(t,o);else{if(g===-1)break;if(l.push(u.substring(o,g)),ne(g+L),p&&($(),T))return z();if(d&&m.length>=d)return z(!0)}return Q();function V(D){m.push(D),E=o}function ee(D){var M=0;return M=D!==-1&&(D=u.substring(h+1,D))&&D.trim()===""?D.length:M}function Q(D){return s||(D===void 0&&(D=u.substring(o)),l.push(D),o=I,V(l),p&&$()),z()}function ne(D){o=D,V(l),l=[],g=u.indexOf(r,o)}function z(D){if(e.header&&!f&&m.length&&!U){var M=m[0],Z=Object.create(null),fe=new Set(M);let _e=!1;for(let te=0;te<M.length;te++){let G=M[te];if(Z[G=b(e.transformHeader)?e.transformHeader(G,te):G]){let se,ye=Z[G];for(;se=G+"_"+ye,ye++,fe.has(se););fe.add(se),M[te]=se,Z[G]++,_e=!0,(P=P===null?{}:P)[se]=G}else Z[G]=1,M[te]=G;fe.add(G)}_e&&console.warn("Duplicate headers found and renamed."),U=!0}return{data:m,errors:x,meta:{delimiter:t,linebreak:r,aborted:T,truncated:!!D,cursor:E+(f||0),renamedHeaders:P}}}function $(){i(z()),m=[],x=[]}},this.abort=function(){T=!0},this.getCharIndex=function(){return o}}function ke(e){var t=e.data,r=N[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){n=!0,ge(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:me,resume:me};if(b(r.userStep)){for(var d=0;d<t.results.data.length&&(r.userStep({data:t.results.data[d],errors:t.results.errors,meta:t.results.meta},i),!n);d++);delete t.results}else b(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!n&&ge(t.workerId,t.results)}function ge(e,t){var r=N[e];b(r.userComplete)&&r.userComplete(t),r.terminate(),delete N[e]}function me(){throw new Error("Not implemented.")}function ce(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ce(e[t]);return r}function X(e,t){return function(){e.apply(t,arguments)}}function b(e){return typeof e=="function"}return a.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(b(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!b(t.transform)&&t.transform,!t.worker||!a.WORKERS_SUPPORTED)return r=null,a.NODE_STREAM_INPUT,typeof e=="string"?(e=(n=>n.charCodeAt(0)!==65279?n:n.slice(1))(e),r=new(t.download?ae:re)(t)):e.readable===!0&&b(e.read)&&b(e.on)?r=new le(t):(_.File&&e instanceof File||e instanceof Object)&&(r=new oe(t)),r.stream(e);(r=(()=>{var n;return!!a.WORKERS_SUPPORTED&&(n=(()=>{var i=_.URL||_.webkitURL||null,d=W.toString();return a.BLOB_URL||(a.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",d,")();"],{type:"text/javascript"})))})(),(n=new _.Worker(n)).onmessage=ke,n.id=Y++,N[n.id]=n)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=b(t.step),t.chunk=b(t.chunk),t.complete=b(t.complete),t.error=b(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},a.unparse=function(e,t){var r=!1,n=!0,i=",",d=`\r
`,O='"',P=O+O,U=!1,c=null,v=!1,o=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||a.BAD_DELIMITERS.filter(function(f){return t.delimiter.indexOf(f)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(U=t.skipEmptyLines),typeof t.newline=="string"&&(d=t.newline),typeof t.quoteChar=="string"&&(O=t.quoteChar),typeof t.header=="boolean"&&(n=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");c=t.columns}t.escapeChar!==void 0&&(P=t.escapeChar+O),t.escapeFormulae instanceof RegExp?v=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(v=/^[=+\-@\t\r].*$/)}})(),new RegExp(ie(O),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return T(null,e,U);if(typeof e[0]=="object")return T(c||Object.keys(e[0]),e,U)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),T(e.fields||[],e.data||[],U);throw new Error("Unable to serialize unrecognized input");function T(f,s,I){var C="",L=(typeof f=="string"&&(f=JSON.parse(f)),typeof s=="string"&&(s=JSON.parse(s)),Array.isArray(f)&&0<f.length),B=!Array.isArray(s[0]);if(L&&n){for(var p=0;p<f.length;p++)0<p&&(C+=i),C+=u(f[p],p);0<s.length&&(C+=d)}for(var m=0;m<s.length;m++){var x=(L?f:s[m]).length,l=!1,E=L?Object.keys(s[m]).length===0:s[m].length===0;if(I&&!L&&(l=I==="greedy"?s[m].join("").trim()==="":s[m].length===1&&s[m][0].length===0),I==="greedy"&&L){for(var A=[],y=0;y<x;y++){var k=B?f[y]:y;A.push(s[m][k])}l=A.join("").trim()===""}if(!l){for(var g=0;g<x;g++){0<g&&!E&&(C+=i);var H=L&&B?f[g]:g;C+=u(s[m][H],g)}m<s.length-1&&(!I||0<x&&!E)&&(C+=d)}}return C}function u(f,s){var I,C;return f==null?"":f.constructor===Date?JSON.stringify(f).slice(1,25):(C=!1,v&&typeof f=="string"&&v.test(f)&&(f="'"+f,C=!0),I=f.toString().replace(o,P),(C=C||r===!0||typeof r=="function"&&r(f,s)||Array.isArray(r)&&r[s]||((L,B)=>{for(var p=0;p<B.length;p++)if(-1<L.indexOf(B[p]))return!0;return!1})(I,a.BAD_DELIMITERS)||-1<I.indexOf(i)||I.charAt(0)===" "||I.charAt(I.length-1)===" ")?O+I+O:I)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!F&&!!_.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=de,a.ParserHandle=pe,a.NetworkStreamer=ae,a.FileStreamer=oe,a.StringStreamer=re,a.ReadableStreamStreamer=le,_.jQuery&&((j=_.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(d){if(!(j(this).prop("tagName").toUpperCase()==="INPUT"&&j(this).attr("type").toLowerCase()==="file"&&_.FileReader)||!this.files||this.files.length===0)return!0;for(var O=0;O<this.files.length;O++)r.push({file:this.files[O],inputElem:this,instanceConfig:j.extend({},t)})}),n(),this;function n(){if(r.length===0)b(e.complete)&&e.complete();else{var d,O,P,U,c=r[0];if(b(e.before)){var v=e.before(c.file,c.inputElem);if(typeof v=="object"){if(v.action==="abort")return d="AbortError",O=c.file,P=c.inputElem,U=v.reason,void(b(e.error)&&e.error({name:d},O,P,U));if(v.action==="skip")return void i();typeof v.config=="object"&&(c.instanceConfig=j.extend(c.instanceConfig,v.config))}else if(v==="skip")return void i()}var o=c.instanceConfig.complete;c.instanceConfig.complete=function(T){b(o)&&o(T,c.file,c.inputElem),i()},a.parse(c.file,c.instanceConfig)}}function i(){r.splice(0,1),n()}}),K&&(_.onmessage=function(e){e=e.data,a.WORKER_ID===void 0&&e&&(a.WORKER_ID=e.workerId),typeof e.input=="string"?_.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(_.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&_.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(ae.prototype=Object.create(J.prototype)).constructor=ae,(oe.prototype=Object.create(J.prototype)).constructor=oe,(re.prototype=Object.create(re.prototype)).constructor=re,(le.prototype=Object.create(J.prototype)).constructor=le,a})})(he)),he.exports}var ze=Te();const Fe=we(ze);function Me({table:S,transform:q,onSuccess:W,className:_}){const j=F=>{Fe.parse(F,{header:!0,skipEmptyLines:!0,complete:async({data:K})=>{try{const N=q?K.map(q):K,{error:Y}=await Ce.from(S).insert(N);if(Y)throw Y;alert("Importación exitosa ✅"),W==null||W()}catch(N){const Y=N.message||"Error desconocido";alert("Error al importar: "+Y)}}})};return R.jsxs("label",{htmlFor:"File",className:"block rounded border border-zinc-300 bg-white p-4 text-zinc-900 shadow-sm sm:p-6 dark:border-zinc-700 dark:bg-zinc-900 dark:text-white",children:[R.jsxs("div",{className:"flex items-center justify-center gap-4",children:[R.jsx("span",{className:"font-medium dark:text-white",children:" Carga tu archivo"}),R.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 7.5h-.75A2.25 2.25 0 0 0 4.5 9.75v7.5a2.25 2.25 0 0 0 2.25 2.25h7.5a2.25 2.25 0 0 0 2.25-2.25v-7.5a2.25 2.25 0 0 0-2.25-2.25h-.75m0-3-3-3m0 0-3 3m3-3v11.25m6-2.25h.75a2.25 2.25 0 0 1 2.25 2.25v7.5a2.25 2.25 0 0 1-2.25 2.25h-7.5a2.25 2.25 0 0 1-2.25-2.25v-.75"})})]}),R.jsx("input",{type:"file",accept:".csv",id:"File",className:"sr-only",onChange:F=>{var N;const K=(N=F.target.files)==null?void 0:N[0];K&&j(K)}})]})}function Ze({}){return[{title:"Materiales"},{name:"description",content:"Materiales"}]}const Ne=[{name:"Id",selector:S=>S.id,width:"80px",sortable:!0},{name:"Descripcion",selector:S=>S.description,sortable:!0,wrap:!0},{name:"Sub-rubro",selector:S=>S.view_categorizations.description_subcategory,width:"220px",sortable:!0,grow:1},{name:"Rubro",selector:S=>S.view_categorizations.description_category,width:"220px",sortable:!0,grow:1},{name:"Familia",selector:S=>S.view_categorizations.description_family,width:"220px",sortable:!0,grow:1},{name:"Unidad",selector:S=>{var q;return((q=S.units)==null?void 0:q.description)||""},sortable:!0,width:"120px"},{name:"Precio",selector:S=>{var q,W,_,j;return(W=(q=S.prices)==null?void 0:q.find(F=>F.default))!=null&&W.price?`$${(j=(_=S.prices.find(F=>F.default))==null?void 0:_.price)==null?void 0:j.toFixed(2)}`:""},sortable:!0,width:"120px"}],Ye=ve(function(){const[q,W]=ue.useState(!1),{getMaterials:_,materials:j}=Ee(),F=xe();ue.useEffect(()=>{j||_()},[]);const[K,N]=ue.useState(j??[]);ue.useEffect(()=>{N(j??[])},[j]);const Y=[{label:"ID",key:"id"},{label:"DESCRIPCION",key:"description"},{label:"ID FAMILIA",key:"view_categorizations.id_family"},{label:"FAMILIA",key:"view_categorizations.description_family"},{label:"ID RUBRO",key:"view_categorizations.id_category"},{label:"RUBRO",key:"view_categorizations.description_category"},{label:"ID SUBRUBRO",key:"view_categorizations.id_subcategory"},{label:"SUBRUBRO",key:"view_categorizations.description_subcategory"},{label:"UNIDAD",key:"units.description"},{label:"ID UNIDAD",key:"id_unit"},{label:"PRECIO",key:"defaultPrice"},{label:"PESO",key:"weight"},{label:"APLICACION",key:"application"}];return j?R.jsxs(Ie,{allowed:Ae,children:[R.jsx(Se,{title:"Materiales",width:"w-full",back_path:"/",IconComponent:{component:je,color:"text-yellow-500"},children:R.jsx(Re,{data:j,columns:Ne,onRowClick:a=>F(`/materials/${a.id}`),filterFields:[{key:"description",label:"Buscar por descripción",autoFilter:!0}],buttonExport:{headers:Y,filename:"Materiales",type:"materials"},buttonNavigate:{route:"/materials/new-material",title:"+ Material",color:"yellow"}})}),R.jsxs(Oe,{open:q,onClose:()=>W(!1),zIndex:10,title:"Seleccionar archivo",children:[R.jsxs("div",{className:"text-zinc-700 dark:text-zinc-300 mb-10 space-y-3",children:[R.jsx("p",{className:"text-md font-semibold",children:"Herramienta de Importación"}),R.jsx("p",{children:"Para ayudarte a preparar los materiales de forma correcta, puedes usar una hoja de Google Sheets que genera el formato compatible con esta importación."}),R.jsxs("ul",{className:"list-disc list-inside text-sm text-zinc-700 dark:text-zinc-300 p-4 bg-zinc-100 dark:bg-zinc-700 rounded-lg",children:[R.jsx("li",{children:"Seleccioná familia, rubro y subrubro desde listas predefinidas."}),R.jsxs("li",{children:["El archivo calcula automáticamente el"," ",R.jsx("code",{className:"text-blue-600 dark:text-blue-400",children:"id_subrubro"})," ","correspondiente."]}),R.jsx("li",{children:"Si la combinación no es válida, te avisa y resalta la fila en naranja."}),R.jsx("li",{children:"También puedes elegir la unidad de medida sin errores de escritura."})]}),R.jsx("a",{href:"https://docs.google.com/spreadsheets/d/1QuuoWQXr5BYu-sZQLGGJ7Z-HOqQxzNxp3nMIHO0M4Ys/edit?gid=1833383596#gid=1833383596",target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-2 text-sm text-primary-text hover:underline",children:"Ver hoja de Google Sheets para preparar archivo →"})]}),R.jsx(Me,{table:"materials",onSuccess:_})]})]}):R.jsx(De,{})});export{Ne as c,Ye as h,Ze as m};
