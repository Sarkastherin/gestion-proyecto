import{r as l,u as b,j as t,c as g,w,O as k}from"./chunk-PVWAREVJ-Cl_c9Jt0.js";import{a as O,u as C}from"./UIContext-9PjeG9pu.js";import{u as p}from"./AuthContext-DiXfFtBN.js";import{P as N}from"./Permission-DpdOa5m8.js";import{a as L,d as z,g as E,f as M,e as S}from"./allowedRoles-wIcqt93s.js";import{u as R}from"./ContactsContext-BtjVusI7.js";import{M as d}from"./ModalBase-Czr0Q5I6.js";import{L as I}from"./LoaderComponent-DzoOhiNN.js";import"./supabaseClient-O5NoNd5h.js";import"./Buttons-DjYWmDVV.js";import"./IconComponent-CkWBZZXK.js";function P({title:e,titleId:r,...o},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},o),e?l.createElement("title",{id:r},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z"}))}const A=l.forwardRef(P);function T({title:e,titleId:r,...o},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},o),e?l.createElement("title",{id:r},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const _=l.forwardRef(T);function F({title:e,titleId:r,...o},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},o),e?l.createElement("title",{id:r},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))}const W=l.forwardRef(F),B=[{name:"Oportunidades",to:"/opportunities",permission:L},{name:"Proyectos",to:"/projects",permission:z},{name:"Materiales",to:"/materials",permission:E},{name:"Configuraciones",to:"/settings",permission:M},{name:"RRHH",to:"/rrhh",permission:S}];function U(){const{user:e,signOut:r}=p(),{toggleTheme:o,theme:n}=O(),s=b(),i=async()=>{await r(),s("/login")},a=({to:c,children:f})=>t.jsx(g,{className:({isActive:m})=>`${m?"text-primary-text font-medium":"text-zinc-800 dark:text-zinc-400 hover:text-primary-text hover:font-medium"}`,to:c,children:f});return t.jsx("header",{className:"sticky top-0 border-b border-zinc-100/70 dark:border-zinc-800/70 bg-gradient-to-bl from-primary/50 via-zinc-300 to-white dark:from-primary-hover/30 dark:via-zinc-900 dark:to-zinc-950 backdrop-blur",children:t.jsxs("div",{className:"mx-auto flex h-16 max-w-screen-xl items-center justify-between px-4 sm:px-6 lg:px-8",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(g,{to:"/",className:"flex items-center gap-2 text-sm font-semibold text-zinc-800 dark:text-zinc-200",children:[t.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/70 text-white dark:text-zinc-200 dark:bg-zinc-900",children:t.jsx(A,{className:"w-5"})}),"Gestion Industrial"]}),t.jsx("nav",{"aria-label":"Global",className:"hidden md:block",children:t.jsx("ul",{className:"flex items-center gap-6 text-sm",children:B.map(c=>t.jsx(N,{roles:c.permission,children:t.jsx("li",{children:t.jsx(a,{to:c.to,children:c.name})})},c.name))})})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"hidden sm:flex items-center gap-2 rounded-full border border-transparent dark:border-zinc-800 bg-primary/70 dark:bg-zinc-900/60 px-3 py-1 text-xs text-white dark:text-zinc-300",children:[t.jsx("span",{className:"h-2 w-2 rounded-full bg-green-300 dark:bg-green-400 "}),"Hola, ",(e==null?void 0:e.name)??"Usuario"]}),t.jsx("button",{type:"button",className:"hidden sm:inline-flex items-center rounded-full border border-primary-text dark:border-zinc-800 px-3 py-1 text-xs text-primary-text dark:text-zinc-300 hover:text-red-600 hover:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 dark:hover:text-red-400 dark:hover:border-red-400",onClick:i,children:"Salir"}),t.jsx("button",{title:"toggle-button-theme",className:"rounded-full border border-primary-text dark:border-zinc-800 p-2 text-primary-text hover:text-primary-hover  dark:hover:text-zinc-300",onClick:o,children:n==="dark"?t.jsx(_,{className:"w-5"}):t.jsx(W,{className:"w-5"})})]})]})})}var D={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function H(e){if(typeof e=="number")return{value:e,unit:"px"};var r,o=(e.match(/^[0-9.]*/)||"").toString();o.includes(".")?r=parseFloat(o):r=parseInt(o,10);var n=(e.match(/[^0-9]*$/)||"").toString();return D[n]?{value:r,unit:n}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(r,"px.")),{value:r,unit:"px"})}function v(e){var r=H(e);return"".concat(r.value).concat(r.unit)}var $=function(e,r,o){var n="react-spinners-".concat(e,"-").concat(o);if(typeof window>"u"||!window.document)return n;var s=document.createElement("style");document.head.appendChild(s);var i=s.sheet,a=`
    @keyframes `.concat(n,` {
      `).concat(r,`
    }
  `);return i&&i.insertRule(a,0),n},u=function(){return u=Object.assign||function(e){for(var r,o=1,n=arguments.length;o<n;o++){r=arguments[o];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},u.apply(this,arguments)},G=function(e,r){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(o[n[s]]=e[n[s]]);return o},V=$("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");function Z(e){var r=e.loading,o=r===void 0?!0:r,n=e.color,s=n===void 0?"#000000":n,i=e.speedMultiplier,a=i===void 0?1:i,c=e.cssOverride,f=c===void 0?{}:c,m=e.size,h=m===void 0?35:m,j=G(e,["loading","color","speedMultiplier","cssOverride","size"]),y=u({background:"transparent !important",width:v(h),height:v(h),borderRadius:"100%",border:"2px solid",borderTopColor:s,borderBottomColor:"transparent",borderLeftColor:s,borderRightColor:s,display:"inline-block",animation:"".concat(V," ").concat(.75/a,"s 0s infinite linear"),animationFillMode:"both"},f);return o?l.createElement("span",u({style:y},j)):null}const x=({message:e})=>t.jsx("div",{className:"flex flex-col items-center justify-center py-4 rounded-lg bg-zinc-200 dark:bg-zinc-700/50",children:t.jsx("div",{className:"text-sm text-zinc-800 dark:text-zinc-300 text-center max-w-xs",children:e})});function q({message:e,onConfirm:r,onClose:o,title:n="Confirmar acción",confirmText:s="Confirmar",cancelText:i="Cancelar"}){return t.jsx(d,{title:n,open:!0,zIndex:100,onClose:o,footer:{btnPrimary:{label:s,handleOnClick:r,variant:"yellow"},btnSecondary:{label:i,handleOnClick:o,variant:"dark"}},children:t.jsx(x,{message:e})})}function J({title:e="⏳ Un momento...",message:r="Se está procesando su requerimiento"}){return t.jsx(d,{title:e,open:!0,zIndex:100,children:t.jsxs("div",{className:"flex flex-col items-center justify-center py-6 gap-4",children:[t.jsx(Z,{color:"#4F46E5",size:40}),t.jsx("p",{className:"text-sm text-zinc-700 dark:text-zinc-300 text-center max-w-xs",children:r})]})})}function K({title:e="ℹ️ Información",message:r,onClose:o,btnSecondary:n}){const s={btnSecondary:n};return t.jsx(d,{title:e,open:!0,zIndex:100,onClose:o,footer:s,children:t.jsx(x,{message:r})})}function Q({title:e="✅ ¡Listo!",message:r="La operación se realizó con éxito.",onClose:o,btnPrimary:n,btnSecondary:s}){const i={btnPrimary:n,btnSecondary:s};return t.jsx(d,{title:e,open:!0,zIndex:100,onClose:o,footer:i,children:t.jsx(x,{message:r})})}function X({title:e="❌ Algo salió mal...",message:r="Ocurrió un error al realizar la operación.",onClose:o,btnSecondary:n}){const s={btnSecondary:n};return t.jsx(d,{title:e,open:!0,zIndex:100,onClose:o,footer:s,children:t.jsx(x,{message:r})})}function Y({steps:e,onClose:r}){const o=e.length>0?e.filter(n=>n.status==="done").length/e.length*100:0;return t.jsx(d,{title:"Progreso",open:!0,zIndex:100,onClose:r,children:t.jsxs("div",{className:"mt-4 space-y-4",children:[t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out",style:{width:`${o}%`}})}),t.jsx("ul",{className:"space-y-2",children:e.map((n,s)=>t.jsxs("li",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`w-3 h-3 rounded-full ${n.status==="done"?"bg-green-500":n.status==="in-progress"?"bg-blue-500 animate-pulse":n.status==="error"?"bg-red-500":"bg-gray-400"}`}),t.jsx("span",{children:n.label})]},s))})]})})}function ee(){const{modal:e,closeModal:r,progressiveSteps:o,setProgressiveSteps:n,updateStep:s}=C(),{type:i,props:a}=e;switch(i){case"LOADING":return t.jsx(J,{message:a==null?void 0:a.message,title:a==null?void 0:a.title});case"SUCCESS":return t.jsx(Q,{onClose:r,message:a==null?void 0:a.message,title:a==null?void 0:a.title,btnPrimary:a==null?void 0:a.btnPrimary,btnSecondary:{label:"Aceptar",handleOnClick:r,variant:"green"}});case"ERROR":return t.jsx(X,{onClose:r,message:a==null?void 0:a.message,title:a==null?void 0:a.title,btnSecondary:{label:"Aceptar",handleOnClick:r,variant:"red"}});case"CONFIRMATION":return t.jsx(q,{onClose:r,message:a==null?void 0:a.message,onConfirm:a==null?void 0:a.onConfirm,title:a==null?void 0:a.title,confirmText:a==null?void 0:a.confirmText,cancelText:a==null?void 0:a.cancelText});case"PROGRESSIVE":return t.jsx(Y,{onClose:r,steps:o});case"INFORMATION":return t.jsx(K,{onClose:r,message:a==null?void 0:a.message,title:a==null?void 0:a.title,btnSecondary:{label:"Aceptar",handleOnClick:r,variant:"blue"}});default:return null}}const ue=w(function(){const{isLoadedContacts:r,setIsLoadedContacts:o}=R(),{auth:n,session:s}=p(),i=b();return l.useEffect(()=>{n(),s||i("/login")},[]),t.jsx(t.Fragment,{children:r?t.jsxs(t.Fragment,{children:[t.jsx(U,{}),t.jsx(k,{}),t.jsx(ee,{})]}):t.jsx("div",{className:"flex justify-center items-center h-screen w-full",children:r===null?t.jsx(I,{content:"Conectando... Por favor espere"}):t.jsx("p",{className:"text-lg text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/50 p-4 rounded mb-4 text-center",children:"Problemas para conectarse a la base de datos de clientes y proveedores"})})})});export{ue as default};
