import{j as e,r as f,w as v,a as _}from"./chunk-PVWAREVJ-Cl_c9Jt0.js";import{S as j,I as S}from"./Inputs-cvlDeTHR.js";import{u as D}from"./DataContext-B4mtDhe5.js";import{D as B,a as w,S as z,V as l,I as M,L as R,T as t,P as C}from"./logo_imindustrial-1ZDqzhFi.js";import{B as I}from"./Buttons-C61rKE9q.js";import"./supabaseClient-O5NoNd5h.js";import"./ContactsContext-BtjVusI7.js";import"./functions-llu_GUtd.js";import"./index-DRz5BQNA.js";import"./IconComponent-CkWBZZXK.js";const s=z.create({page:{padding:30,fontSize:11,color:"#333"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:"1px",borderBottomColor:"#999",paddingBottom:10},logo:{height:70,resizeMode:"contain",alignSelf:"flex-start"},h1:{fontSize:20,fontWeight:"700"},h2:{fontSize:14,fontWeight:"700",marginBottom:10},body:{paddingTop:20},fontBody:{fontWeight:"600",marginRight:10},descripcion:{display:"flex",flexDirection:"row",marginBottom:8},table:{borderTop:"1px solid #9ca3af",borderLeft:"1px solid #9ca3af",borderRight:"1px solid #9ca3af"},thead:{fontWeight:700},row:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingLeft:8,paddingRight:8,height:25,borderBottom:"1px solid #9ca3af"},tbody:{display:"flex",flexDirection:"row",justifyContent:"space-between"},cell:{}});function T({quote:a,quoteId:i,settings:c,selectedOpportunity:r}){var y,x;const m=isFinite(c.exchangeRate)&&c.exchangeRate>0?c.exchangeRate:1,d=o=>(c.currency==="USD"?o:o*m).toLocaleString("es-AR",{style:"currency",currency:c.currency,minimumFractionDigits:2}),n=(()=>{switch(c.model){case"closed":return[{label:"Precio Global",value:a.t_mg_total}];case"byType":return[{label:"Materiales",value:a.t_mg_materials},{label:"Mano de obra",value:a.t_mg_labor},{label:"Subcontratos",value:a.t_mg_subcontracting},{label:"Otros",value:a.t_mg_others}];case"groupedServices":return[{label:"Materiales",value:a.t_mg_materials},{label:"Servicios",value:a.t_mg_labor+a.t_mg_subcontracting},{label:"Otros",value:a.t_mg_others}];case"useCategory":return[{label:"Costos Directos",value:a.t_mg_materials+a.t_mg_labor},{label:"Costos Indirectos",value:a.t_mg_subcontracting+a.t_mg_others}];case"materialsOnly":return[{label:"Materiales",value:a.t_mg_materials},{label:"Mano de Obra - Subcontratos - Otros",value:a.t_mg_labor+a.t_mg_subcontracting+a.t_mg_others}];default:return[]}})(),u=n.reduce((o,p)=>o+p.value,0),h=new Date().toLocaleString("es-AR",{year:"numeric",day:"numeric",month:"long"});return e.jsx(B,{children:e.jsxs(w,{size:"A4",style:s.page,children:[e.jsxs(l,{style:s.header,children:[e.jsx(M,{src:R,style:s.logo}),e.jsxs(l,{children:[e.jsxs(t,{style:s.h1,children:["Cotizaci贸n Nro: ",i]}),e.jsxs(t,{style:{marginTop:10},children:["Fecha: ",h]})]})]}),e.jsxs(l,{style:s.body,children:[e.jsxs(l,{style:{marginBottom:20},children:[e.jsx(t,{style:s.h2,children:"Datos de la oportunidad"}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Nombre",":"]}),e.jsx(t,{style:{flex:1},children:r==null?void 0:r.name})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Cliente",":"]}),e.jsx(t,{style:{flex:1},children:r==null?void 0:r.client.nombre})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Alcance del Servicio",":"]}),e.jsx(t,{style:{flex:1},children:r==null?void 0:r.scope})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Etapas",":"]}),e.jsx(t,{style:{flex:1},children:r==null?void 0:r.phases.map(o=>o.name).join(" - ")})]})]}),e.jsxs(l,{style:{marginBottom:10},children:[e.jsx(t,{style:s.h2,children:"Datos de cotizaci贸n"}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Fecha Probable de Inicio de Obra:",":"]}),e.jsx(t,{style:{flex:1},children:a.estimated_start_date})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Vigencia de la Cotizaci贸n",":"]}),e.jsx(t,{style:{flex:1},children:a.validity})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Plazo de Ejecuci贸n",":"]}),e.jsx(t,{style:{flex:1},children:a.delivery_time})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Forma de Pago",":"]}),e.jsx(t,{style:{flex:1},children:a.method_payment})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Garant铆a",":"]}),e.jsx(t,{style:{flex:1},children:a.guarantee})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Notas",":"]}),e.jsx(t,{style:{flex:1},children:a.notes})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Moneda",":"]}),e.jsx(t,{style:{flex:1},children:(y=b.find(o=>o.value===c.currency))==null?void 0:y.label})]}),e.jsxs(l,{style:s.descripcion,children:[e.jsxs(t,{style:s.fontBody,children:["Presentaci贸n",":"]}),e.jsx(t,{style:{flex:1},children:(x=g.find(o=>o.mode===c.model))==null?void 0:x.name})]})]}),e.jsx(l,{style:{marginBottom:20},children:e.jsxs(l,{style:s.table,children:[e.jsx(l,{style:s.thead,children:e.jsxs(l,{style:s.row,children:[e.jsx(t,{children:"Categor铆a"}),e.jsx(t,{children:"Total"})]})}),n.map(o=>e.jsxs(l,{style:s.row,children:[e.jsx(t,{children:o.label}),e.jsx(t,{children:d(o.value)})]},o.label)),e.jsxs(l,{style:[s.row,{fontWeight:700}],children:[e.jsx(t,{children:"Total"}),e.jsx(t,{children:d(u)})]})]})})]})]})})}function N({quoteActive:a,settings:i}){const{selectedOpportunity:c}=D(),{quotes:r}=c||{},[m,d]=f.useState(r==null?void 0:r.find(n=>n.id===a));return f.useEffect(()=>{d(r==null?void 0:r.find(n=>n.id===a))},[a]),e.jsx("div",{style:{height:"calc(100vh - 270px)"},children:e.jsx(C,{width:"100%",height:"100%",children:m&&e.jsx(T,{quote:m,quoteId:a,settings:i,selectedOpportunity:c})},JSON.stringify(i))})}const P=({description:a})=>a?e.jsxs("div",{className:"mt-4 rounded-md border border-zinc-300 dark:border-zinc-700 bg-white dark:bg-zinc-900 px-4 py-3 shadow-sm",children:[e.jsx("h4",{className:"text-base font-semibold text-primary-text mb-2",children:a.name}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-2",children:a.paragraph}),e.jsx("ul",{className:"list-disc list-inside text-sm text-zinc-600 dark:text-zinc-400 space-y-1",children:a.listDescription.map(i=>e.jsx("li",{children:i},i))})]}):null;function J({}){return[{title:"Oportunidad [Informes]"},{name:"description",content:"Oportunidad [Informes]"}]}const b=[{value:"USD",label:"D贸lares americanos"},{value:"ARS",label:"Pesos argentinos"}],g=[{name:"Precio Global",mode:"closed",listDescription:["Muestra un solo total global, sin desglose.","Ideal para ofertas paquetizadas o clientes que no necesitan ver detalle."],active:!0},{name:"Total por tipo",mode:"byType",paragraph:"Muestra los 4 bloques por separado:",listDescription:["Materiales","Mano de obra","Subcontratos","Otros"],active:!0},{name:"Servicios",mode:"groupedServices",paragraph:"Muestra 3 bloques, agrupando mano de obra y subcontratos en una etiqueta 'Servicios':",listDescription:["Materiales","Servicios","Otros"],active:!1},{name:"Directos e indirectos",mode:"useCategory",paragraph:"Categoriza la cotizaci贸n en 2 bloques:",listDescription:["Directos (materiales, mano de obra)","Indirectos (subcontratos, otros)"],active:!1},{name:"Materiales + Mano de Obra",mode:"materialsOnly",listDescription:["Agrupa mano de obra, subcontratos y otros en 'Mano de Obra'","Total de Materiales"],active:!0}],H=v(function(){const[i,c]=f.useState({currency:"USD",exchangeRate:1,model:"byType"}),{selectedQuoteId:r}=_(),m=()=>{const n=document.getElementById("currency"),u=n?n.value:"",h=document.getElementById("exchangeRate"),y=h?h.value:"",x=document.getElementById("model"),o=x?x.value:"";c({currency:u,exchangeRate:Number(y),model:o})},d=f.useMemo(()=>g.find(n=>n.mode===i.model),[i.model]);return e.jsxs("div",{className:"w-full mt-8 mx-auto flex gap-6 px-8",children:[e.jsxs("div",{className:"w-fit",children:[e.jsx("h3",{className:"text-2xl font-medium mb-6",children:"Opciones"}),e.jsxs("div",{className:"flex flex-col gap-10",children:[e.jsxs("div",{children:[e.jsx(j,{id:"currency",label:"Tipo de moneda",selectText:"Seleccione una modena",defaultValue:i.currency,children:b.map(n=>e.jsxs("option",{value:n.value,children:[n.label," ",n.value==="USD"?" 吼":" "]},n.value))}),e.jsx(S,{id:"exchangeRate",label:"Tasa de cambio",type:"number",step:.01,defaultValue:i.exchangeRate}),e.jsx(j,{id:"model",label:"Modelo de tabla",defaultValue:i.model,children:g.filter(n=>n.active).map(n=>e.jsx("option",{value:n.mode,children:n.name},n.mode))}),d&&e.jsx(P,{description:d})]}),e.jsx(I,{variant:"red",onClick:m,children:"Generar nuevo PDF"})]})]}),e.jsx("div",{className:"w-full",children:r&&e.jsx(N,{quoteActive:r,settings:i})})]})});export{H as default,J as meta};
