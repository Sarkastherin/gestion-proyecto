import{g as ve,j as b,w as we,r as ue,u as xe}from"./chunk-PVWAREVJ-Cl_c9Jt0.js";import{u as Ee}from"./DataContext-BHROWMOn.js";import{E as Re}from"./EntityTable-DKwDIY9O.js";import{B as Ce}from"./Buttons-DjYWmDVV.js";import{a as Se}from"./Buttons-ByA9cNaT.js";import{s as Ie}from"./supabaseClient-O5NoNd5h.js";import{F as Oe}from"./FooterUITable-C66h8R_K.js";import{C as je}from"./Containers-ZXGJ7diH.js";import{M as Ae}from"./ModalBase-Czr0Q5I6.js";import{P as De}from"./ProtectedRoute-DTKDj7Jz.js";import{g as Le}from"./allowedRoles-wIcqt93s.js";import{L as Fe}from"./LoaderComponent-DzoOhiNN.js";import{B as Te}from"./box-BumqmFUH.js";var he={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var ze=he.exports,be;function Me(){return be||(be=1,(function(S,W){((P,_)=>{S.exports=_()})(ze,function P(){var _=typeof self<"u"?self:typeof window<"u"?window:_!==void 0?_:{},D,z=!_.document&&!!_.postMessage,H=_.IS_PAPA_WORKER||!1,N={},Y=0,a={};function K(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=ce(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new pe(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let d=this._config.newline;d||(i=this._config.quoteChar||'"',d=this._handle.guessLineEndings(t,i)),t=[...t.split(d).slice(s)].join(d)}this.isFirstChunk&&k(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),H)_.postMessage({results:i,workerId:a.WORKER_ID,finished:s});else if(k(this._config.chunk)&&!r){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!k(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){k(this._config.error)?this._config.error(t):H&&this._config.error&&_.postMessage({workerId:a.WORKER_ID,error:t,finished:!1})}}function ae(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),K.call(this,e),this._nextChunk=z?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),z||(t.onload=X(this._chunkLoaded,this),t.onerror=X(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!z),this._config.downloadRequestHeaders){var r,s=this._config.downloadRequestHeaders;for(r in s)t.setRequestHeader(r,s[r])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(d){this._chunkError(d.message)}z&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function oe(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),K.call(this,e);var t,r,s=typeof FileReader<"u";this.stream=function(i){this._input=i,r=i.slice||i.webkitSlice||i.mozSlice,s?((t=new FileReader).onload=X(this._chunkLoaded,this),t.onerror=X(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,d=(this._config.chunkSize&&(d=Math.min(this._start+this._config.chunkSize,this._input.size),i=r.call(i,this._start,d)),t.readAsText(i,this._config.encoding));s||this._chunkLoaded({target:{result:d}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function re(e){var t;K.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,s;if(!this._finished)return r=this._config.chunkSize,t=r?(s=t.substring(0,r),t.substring(r)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function le(e){K.call(this,e=e||{});var t=[],r=!0,s=!1;this.pause=function(){K.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){K.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=X(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(d){this._streamError(d)}},this),this._streamError=X(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=X(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=X(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function pe(e){var t,r,s,i,d=Math.pow(2,53),I=-d,U=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,B=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,x=0,o=0,F=!1,u=!1,f=[],n={data:[],errors:[],meta:{}};function O(p){return e.skipEmptyLines==="greedy"?p.join("").trim()==="":p.length===1&&p[0].length===0}function C(){if(n&&s&&(q("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(n.data=n.data.filter(function(l){return!O(l)})),L()){let l=function(R,j){k(e.transformHeader)&&(R=e.transformHeader(R,j)),f.push(R)};if(n)if(Array.isArray(n.data[0])){for(var p=0;L()&&p<n.data.length;p++)n.data[p].forEach(l);n.data.splice(0,1)}else n.data.forEach(l)}function m(l,R){for(var j=e.header?{}:[],y=0;y<l.length;y++){var v=y,g=l[y],g=((Q,h)=>(w=>(e.dynamicTypingFunction&&e.dynamicTyping[w]===void 0&&(e.dynamicTyping[w]=e.dynamicTypingFunction(w)),(e.dynamicTyping[w]||e.dynamicTyping)===!0))(Q)?h==="true"||h==="TRUE"||h!=="false"&&h!=="FALSE"&&((w=>{if(U.test(w)&&(w=parseFloat(w),I<w&&w<d))return 1})(h)?parseFloat(h):B.test(h)?new Date(h):h===""?null:h):h)(v=e.header?y>=f.length?"__parsed_extra":f[y]:v,g=e.transform?e.transform(g,v):g);v==="__parsed_extra"?(j[v]=j[v]||[],j[v].push(g)):j[v]=g}return e.header&&(y>f.length?q("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+y,o+R):y<f.length&&q("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+y,o+R)),j}var E;n&&(e.header||e.dynamicTyping||e.transform)&&(E=1,!n.data.length||Array.isArray(n.data[0])?(n.data=n.data.map(m),E=n.data.length):n.data=m(n.data,0),e.header&&n.meta&&(n.meta.fields=f),o+=E)}function L(){return e.header&&f.length===0}function q(p,m,E,l){p={type:p,code:m,message:E},l!==void 0&&(p.row=l),n.errors.push(p)}k(e.step)&&(i=e.step,e.step=function(p){n=p,L()?C():(C(),n.data.length!==0&&(x+=p.data.length,e.preview&&x>e.preview?r.abort():(n.data=n.data[0],i(n,c))))}),this.parse=function(p,m,E){var l=e.quoteChar||'"',l=(e.newline||(e.newline=this.guessLineEndings(p,l)),s=!1,e.delimiter?k(e.delimiter)&&(e.delimiter=e.delimiter(p),n.meta.delimiter=e.delimiter):((l=((R,j,y,v,g)=>{var Q,h,w,V;g=g||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var ee=0;ee<g.length;ee++){for(var $,se=g[ee],T=0,G=0,A=0,M=(w=void 0,new de({comments:v,delimiter:se,newline:j,preview:10}).parse(R)),Z=0;Z<M.data.length;Z++)y&&O(M.data[Z])?A++:($=M.data[Z].length,G+=$,w===void 0?w=$:0<$&&(T+=Math.abs($-w),w=$));0<M.data.length&&(G/=M.data.length-A),(h===void 0||T<=h)&&(V===void 0||V<G)&&1.99<G&&(h=T,Q=se,V=G)}return{successful:!!(e.delimiter=Q),bestDelimiter:Q}})(p,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(s=!0,e.delimiter=a.DefaultDelimiter),n.meta.delimiter=e.delimiter),ce(e));return e.preview&&e.header&&l.preview++,t=p,r=new de(l),n=r.parse(t,m,E),C(),F?{meta:{paused:!0}}:n||{meta:{paused:!1}}},this.paused=function(){return F},this.pause=function(){F=!0,r.abort(),t=k(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){c.streamer._halted?(F=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return u},this.abort=function(){u=!0,r.abort(),n.meta.aborted=!0,k(e.complete)&&e.complete(n),t=""},this.guessLineEndings=function(R,l){R=R.substring(0,1048576);var l=new RegExp(ie(l)+"([^]*?)"+ie(l),"gm"),E=(R=R.replace(l,"")).split("\r"),l=R.split(`
`),R=1<l.length&&l[0].length<E[0].length;if(E.length===1||R)return`
`;for(var j=0,y=0;y<E.length;y++)E[y][0]===`
`&&j++;return j>=E.length/2?`\r
`:"\r"}}function ie(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function de(e){var t=(e=e||{}).delimiter,r=e.newline,s=e.comments,i=e.step,d=e.preview,I=e.fastMode,U=null,B=!1,c=e.quoteChar==null?'"':e.quoteChar,x=c;if(e.escapeChar!==void 0&&(x=e.escapeChar),(typeof t!="string"||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<a.BAD_DELIMITERS.indexOf(s))&&(s=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var o=0,F=!1;this.parse=function(u,f,n){if(typeof u!="string")throw new Error("Input must be a string");var O=u.length,C=t.length,L=r.length,q=s.length,p=k(i),m=[],E=[],l=[],R=o=0;if(!u)return T();if(I||I!==!1&&u.indexOf(c)===-1){for(var j=u.split(r),y=0;y<j.length;y++){if(l=j[y],o+=l.length,y!==j.length-1)o+=r.length;else if(n)return T();if(!s||l.substring(0,q)!==s){if(p){if(m=[],V(l.split(t)),G(),F)return T()}else V(l.split(t));if(d&&d<=y)return m=m.slice(0,d),T(!0)}}return T()}for(var v=u.indexOf(t,o),g=u.indexOf(r,o),Q=new RegExp(ie(x)+ie(c),"g"),h=u.indexOf(c,o);;)if(u[o]===c)for(h=o,o++;;){if((h=u.indexOf(c,h+1))===-1)return n||E.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:m.length,index:o}),$();if(h===O-1)return $(u.substring(o,h).replace(Q,c));if(c===x&&u[h+1]===x)h++;else if(c===x||h===0||u[h-1]!==x){v!==-1&&v<h+1&&(v=u.indexOf(t,h+1));var w=ee((g=g!==-1&&g<h+1?u.indexOf(r,h+1):g)===-1?v:Math.min(v,g));if(u.substr(h+1+w,C)===t){l.push(u.substring(o,h).replace(Q,c)),u[o=h+1+w+C]!==c&&(h=u.indexOf(c,o)),v=u.indexOf(t,o),g=u.indexOf(r,o);break}if(w=ee(g),u.substring(h+1+w,h+1+w+L)===r){if(l.push(u.substring(o,h).replace(Q,c)),se(h+1+w+L),v=u.indexOf(t,o),h=u.indexOf(c,o),p&&(G(),F))return T();if(d&&m.length>=d)return T(!0);break}E.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:m.length,index:o}),h++}}else if(s&&l.length===0&&u.substring(o,o+q)===s){if(g===-1)return T();o=g+L,g=u.indexOf(r,o),v=u.indexOf(t,o)}else if(v!==-1&&(v<g||g===-1))l.push(u.substring(o,v)),o=v+C,v=u.indexOf(t,o);else{if(g===-1)break;if(l.push(u.substring(o,g)),se(g+L),p&&(G(),F))return T();if(d&&m.length>=d)return T(!0)}return $();function V(A){m.push(A),R=o}function ee(A){var M=0;return M=A!==-1&&(A=u.substring(h+1,A))&&A.trim()===""?A.length:M}function $(A){return n||(A===void 0&&(A=u.substring(o)),l.push(A),o=O,V(l),p&&G()),T()}function se(A){o=A,V(l),l=[],g=u.indexOf(r,o)}function T(A){if(e.header&&!f&&m.length&&!B){var M=m[0],Z=Object.create(null),fe=new Set(M);let _e=!1;for(let te=0;te<M.length;te++){let J=M[te];if(Z[J=k(e.transformHeader)?e.transformHeader(J,te):J]){let ne,ye=Z[J];for(;ne=J+"_"+ye,ye++,fe.has(ne););fe.add(ne),M[te]=ne,Z[J]++,_e=!0,(U=U===null?{}:U)[ne]=J}else Z[J]=1,M[te]=J;fe.add(J)}_e&&console.warn("Duplicate headers found and renamed."),B=!0}return{data:m,errors:E,meta:{delimiter:t,linebreak:r,aborted:F,truncated:!!A,cursor:R+(f||0),renamedHeaders:U}}}function G(){i(T()),m=[],E=[]}},this.abort=function(){F=!0},this.getCharIndex=function(){return o}}function ke(e){var t=e.data,r=N[t.workerId],s=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){s=!0,ge(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:me,resume:me};if(k(r.userStep)){for(var d=0;d<t.results.data.length&&(r.userStep({data:t.results.data[d],errors:t.results.errors,meta:t.results.meta},i),!s);d++);delete t.results}else k(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!s&&ge(t.workerId,t.results)}function ge(e,t){var r=N[e];k(r.userComplete)&&r.userComplete(t),r.terminate(),delete N[e]}function me(){throw new Error("Not implemented.")}function ce(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ce(e[t]);return r}function X(e,t){return function(){e.apply(t,arguments)}}function k(e){return typeof e=="function"}return a.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(k(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!k(t.transform)&&t.transform,!t.worker||!a.WORKERS_SUPPORTED)return r=null,a.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),r=new(t.download?ae:re)(t)):e.readable===!0&&k(e.read)&&k(e.on)?r=new le(t):(_.File&&e instanceof File||e instanceof Object)&&(r=new oe(t)),r.stream(e);(r=(()=>{var s;return!!a.WORKERS_SUPPORTED&&(s=(()=>{var i=_.URL||_.webkitURL||null,d=P.toString();return a.BLOB_URL||(a.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",d,")();"],{type:"text/javascript"})))})(),(s=new _.Worker(s)).onmessage=ke,s.id=Y++,N[s.id]=s)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=k(t.step),t.chunk=k(t.chunk),t.complete=k(t.complete),t.error=k(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},a.unparse=function(e,t){var r=!1,s=!0,i=",",d=`\r
`,I='"',U=I+I,B=!1,c=null,x=!1,o=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||a.BAD_DELIMITERS.filter(function(f){return t.delimiter.indexOf(f)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(B=t.skipEmptyLines),typeof t.newline=="string"&&(d=t.newline),typeof t.quoteChar=="string"&&(I=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");c=t.columns}t.escapeChar!==void 0&&(U=t.escapeChar+I),t.escapeFormulae instanceof RegExp?x=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(x=/^[=+\-@\t\r].*$/)}})(),new RegExp(ie(I),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return F(null,e,B);if(typeof e[0]=="object")return F(c||Object.keys(e[0]),e,B)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),F(e.fields||[],e.data||[],B);throw new Error("Unable to serialize unrecognized input");function F(f,n,O){var C="",L=(typeof f=="string"&&(f=JSON.parse(f)),typeof n=="string"&&(n=JSON.parse(n)),Array.isArray(f)&&0<f.length),q=!Array.isArray(n[0]);if(L&&s){for(var p=0;p<f.length;p++)0<p&&(C+=i),C+=u(f[p],p);0<n.length&&(C+=d)}for(var m=0;m<n.length;m++){var E=(L?f:n[m]).length,l=!1,R=L?Object.keys(n[m]).length===0:n[m].length===0;if(O&&!L&&(l=O==="greedy"?n[m].join("").trim()==="":n[m].length===1&&n[m][0].length===0),O==="greedy"&&L){for(var j=[],y=0;y<E;y++){var v=q?f[y]:y;j.push(n[m][v])}l=j.join("").trim()===""}if(!l){for(var g=0;g<E;g++){0<g&&!R&&(C+=i);var Q=L&&q?f[g]:g;C+=u(n[m][Q],g)}m<n.length-1&&(!O||0<E&&!R)&&(C+=d)}}return C}function u(f,n){var O,C;return f==null?"":f.constructor===Date?JSON.stringify(f).slice(1,25):(C=!1,x&&typeof f=="string"&&x.test(f)&&(f="'"+f,C=!0),O=f.toString().replace(o,U),(C=C||r===!0||typeof r=="function"&&r(f,n)||Array.isArray(r)&&r[n]||((L,q)=>{for(var p=0;p<q.length;p++)if(-1<L.indexOf(q[p]))return!0;return!1})(O,a.BAD_DELIMITERS)||-1<O.indexOf(i)||O.charAt(0)===" "||O.charAt(O.length-1)===" ")?I+O+I:O)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!z&&!!_.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=de,a.ParserHandle=pe,a.NetworkStreamer=ae,a.FileStreamer=oe,a.StringStreamer=re,a.ReadableStreamStreamer=le,_.jQuery&&((D=_.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(d){if(!(D(this).prop("tagName").toUpperCase()==="INPUT"&&D(this).attr("type").toLowerCase()==="file"&&_.FileReader)||!this.files||this.files.length===0)return!0;for(var I=0;I<this.files.length;I++)r.push({file:this.files[I],inputElem:this,instanceConfig:D.extend({},t)})}),s(),this;function s(){if(r.length===0)k(e.complete)&&e.complete();else{var d,I,U,B,c=r[0];if(k(e.before)){var x=e.before(c.file,c.inputElem);if(typeof x=="object"){if(x.action==="abort")return d="AbortError",I=c.file,U=c.inputElem,B=x.reason,void(k(e.error)&&e.error({name:d},I,U,B));if(x.action==="skip")return void i();typeof x.config=="object"&&(c.instanceConfig=D.extend(c.instanceConfig,x.config))}else if(x==="skip")return void i()}var o=c.instanceConfig.complete;c.instanceConfig.complete=function(F){k(o)&&o(F,c.file,c.inputElem),i()},a.parse(c.file,c.instanceConfig)}}function i(){r.splice(0,1),s()}}),H&&(_.onmessage=function(e){e=e.data,a.WORKER_ID===void 0&&e&&(a.WORKER_ID=e.workerId),typeof e.input=="string"?_.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(_.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&_.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(ae.prototype=Object.create(K.prototype)).constructor=ae,(oe.prototype=Object.create(K.prototype)).constructor=oe,(re.prototype=Object.create(re.prototype)).constructor=re,(le.prototype=Object.create(K.prototype)).constructor=le,a})})(he)),he.exports}var Ne=Me();const Pe=ve(Ne);function Ue({table:S,transform:W,onSuccess:P,className:_}){const D=z=>{Pe.parse(z,{header:!0,skipEmptyLines:!0,complete:async({data:H})=>{try{const N=W?H.map(W):H,{error:Y}=await Ie.from(S).insert(N);if(Y)throw Y;alert("Importación exitosa ✅"),P==null||P()}catch(N){const Y=N.message||"Error desconocido";alert("Error al importar: "+Y)}}})};return b.jsxs("label",{htmlFor:"File",className:"block rounded border border-zinc-300 bg-white p-4 text-zinc-900 shadow-sm sm:p-6 dark:border-zinc-700 dark:bg-zinc-900 dark:text-white",children:[b.jsxs("div",{className:"flex items-center justify-center gap-4",children:[b.jsx("span",{className:"font-medium dark:text-white",children:" Carga tu archivo"}),b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 7.5h-.75A2.25 2.25 0 0 0 4.5 9.75v7.5a2.25 2.25 0 0 0 2.25 2.25h7.5a2.25 2.25 0 0 0 2.25-2.25v-7.5a2.25 2.25 0 0 0-2.25-2.25h-.75m0-3-3-3m0 0-3 3m3-3v11.25m6-2.25h.75a2.25 2.25 0 0 1 2.25 2.25v7.5a2.25 2.25 0 0 1-2.25 2.25h-7.5a2.25 2.25 0 0 1-2.25-2.25v-.75"})})]}),b.jsx("input",{type:"file",accept:".csv",id:"File",className:"sr-only",onChange:z=>{var N;const H=(N=z.target.files)==null?void 0:N[0];H&&D(H)}})]})}function tt({}){return[{title:"Materiales"},{name:"description",content:"Materiales"}]}const Be=[{name:"Id",selector:S=>S.id,width:"80px",sortable:!0},{name:"Descripcion",selector:S=>S.description,sortable:!0,wrap:!0},{name:"Sub-rubro",selector:S=>S.view_categorizations.description_subcategory,width:"220px",sortable:!0,grow:1},{name:"Rubro",selector:S=>S.view_categorizations.description_category,width:"220px",sortable:!0,grow:1},{name:"Familia",selector:S=>S.view_categorizations.description_family,width:"220px",sortable:!0,grow:1},{name:"Unidad",selector:S=>{var W;return((W=S.units)==null?void 0:W.description)||""},sortable:!0,width:"120px"},{name:"Precio",selector:S=>{var W,P,_,D;return(P=(W=S.prices)==null?void 0:W.find(z=>z.default))!=null&&P.price?`$${(D=(_=S.prices.find(z=>z.default))==null?void 0:_.price)==null?void 0:D.toFixed(2)}`:""},sortable:!0,width:"120px"}],rt=we(function(){const[W,P]=ue.useState(!1),{getMaterials:_,materials:D}=Ee(),z=xe();ue.useEffect(()=>{D||_()},[]);const[H,N]=ue.useState(D??[]);ue.useEffect(()=>{N(D??[])},[D]);const Y=()=>{P(!0)},a=[{label:"ID",key:"id"},{label:"DESCRIPCION",key:"description"},{label:"ID FAMILIA",key:"view_categorizations.id_family"},{label:"FAMILIA",key:"view_categorizations.description_family"},{label:"ID RUBRO",key:"view_categorizations.id_category"},{label:"RUBRO",key:"view_categorizations.description_category"},{label:"ID SUBRUBRO",key:"view_categorizations.id_subcategory"},{label:"SUBRUBRO",key:"view_categorizations.description_subcategory"},{label:"UNIDAD",key:"units.description"},{label:"ID UNIDAD",key:"id_unit"},{label:"PRECIO",key:"defaultPrice"},{label:"PESO",key:"weight"},{label:"APLICACION",key:"application"}];return D?b.jsxs(De,{allowed:Le,children:[b.jsx(je,{title:"Materiales",width:"w-full",back_path:"/",IconComponent:{component:Te,color:"text-yellow-500"},children:b.jsx(Re,{data:D,columns:Be,onRowClick:K=>z(`/materials/${K.id}`),filterFields:[{key:"description",label:"Buscar por descripción",autoFilter:!0}]})}),b.jsx(Oe,{justify:"justify-between",buttonNavigate:{title:"+ Material",route:"/materials/new-material",color:"yellow"},children:b.jsxs("div",{className:"flex gap-4",children:[b.jsx("div",{className:"w-fit",children:b.jsx(Ce,{variant:"blue",type:"button",onClick:Y,children:"Importar"})}),b.jsx(Se,{data:H,headers:a,filename:"Listado de materiales",type:"materials"})]})}),b.jsxs(Ae,{open:W,onClose:()=>P(!1),zIndex:10,title:"Seleccionar archivo",children:[b.jsxs("div",{className:"text-zinc-700 dark:text-zinc-300 mb-10 space-y-3",children:[b.jsx("p",{className:"text-md font-semibold",children:"Herramienta de Importación"}),b.jsx("p",{children:"Para ayudarte a preparar los materiales de forma correcta, puedes usar una hoja de Google Sheets que genera el formato compatible con esta importación."}),b.jsxs("ul",{className:"list-disc list-inside text-sm text-zinc-700 dark:text-zinc-300 p-4 bg-zinc-100 dark:bg-zinc-700 rounded-lg",children:[b.jsx("li",{children:"Seleccioná familia, rubro y subrubro desde listas predefinidas."}),b.jsxs("li",{children:["El archivo calcula automáticamente el"," ",b.jsx("code",{className:"text-blue-600 dark:text-blue-400",children:"id_subrubro"})," ","correspondiente."]}),b.jsx("li",{children:"Si la combinación no es válida, te avisa y resalta la fila en naranja."}),b.jsx("li",{children:"También puedes elegir la unidad de medida sin errores de escritura."})]}),b.jsx("a",{href:"https://docs.google.com/spreadsheets/d/1QuuoWQXr5BYu-sZQLGGJ7Z-HOqQxzNxp3nMIHO0M4Ys/edit?gid=1833383596#gid=1833383596",target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-2 text-sm text-primary-text hover:underline",children:"Ver hoja de Google Sheets para preparar archivo →"})]}),b.jsx(Ue,{table:"materials",onSuccess:_})]})]}):b.jsx(Fe,{})});export{Be as c,rt as h,tt as m};
