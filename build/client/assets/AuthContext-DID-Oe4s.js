import{r as o,j as m}from"./chunk-PVWAREVJ-xN2wnjH-.js";import{s as e}from"./UIContext-DAvkThde.js";const i=o.createContext(void 0),w=()=>{const n=o.useContext(i);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},A=({children:n})=>{const[c,h]=o.useState(null),[u,a]=o.useState(null),d=async()=>{e.auth.getSession().then(({data:{session:s}})=>{a(s)});const{data:{subscription:t}}=e.auth.onAuthStateChange((s,r)=>{a(r)});return u&&l(u.user.id),()=>t.unsubscribe()},l=async t=>{try{const{data:s,error:r}=await e.from("users").select("*").eq("auth_user_id",t);if(r){alert(`No se pudo acceder al servidor: Error: ${r.message}`);return}h(s[0]);return}catch(s){console.error("Error fetching user:",s);return}},g=async({email:t,password:s})=>{const{data:r,error:f}=await e.auth.signInWithPassword({email:t,password:s});return{data:r,error:f}},x=async()=>{const{error:t}=await e.auth.signOut();return t||null};return m.jsx(i.Provider,{value:{user:c,session:u,signIn:g,signOut:x,auth:d},children:n})};export{A,w as u};
