const p=async({fieldsArray:u,dirtyFields:l,fieldName:w,fieldsDelete:g,onUpdate:h,onInsert:m,onRemove:E})=>{const y=l[w]??[];let t=[];await Promise.all(u.map(async(r,s)=>{const a="id"in r,n=y[s]??{},f=Object.values(n).some(e=>e);if(a&&f){const o=Object.keys(n).reduce((d,c)=>(d[c]=r[c],d),{}),{error:i}=await h({id:r.id,values:o});if(i)throw new Error(`Error actualizando el registro con id=${r.id}: ${i.message}`)}else if(!a){const{data:e,error:o}=await m(r);if(o)throw console.error("Error insertando nuevo registro:",o,r),new Error(`Error insertando un nuevo registro: ${o.message}`);e!==null&&(t=[e,...t])}}));for(const r of g){const{error:s}=await E(r);if(s)throw new Error(`Error eliminando el registro con id=${r}: ${s.message}`)}return t};export{p as u};
