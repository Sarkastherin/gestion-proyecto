import{r,w as v,d as M,j as t}from"./chunk-PVWAREVJ-Cl_c9Jt0.js";import{C as _}from"./Containers-ZXGJ7diH.js";import{u as D}from"./DataContext-B4mtDhe5.js";import{C as b}from"./Cards-BPIQ6iiA.js";import{u as C}from"./ContactsContext-BtjVusI7.js";import{u as R}from"./useModalState-Dynfoma4.js";import{D as E}from"./DailyReportModal-CXpe6OGf.js";import{B as u}from"./Buttons-C61rKE9q.js";import{B as N}from"./Badge-BNjmnaCE.js";import{f as x}from"./functionsDays-BZooa-Ef.js";import{c as B}from"./realTime-VCRs_Sia.js";import"./IconComponent-CkWBZZXK.js";import"./arrow-left-3CO6tBoR.js";import"./supabaseClient-O5NoNd5h.js";import"./functions-llu_GUtd.js";import"./ModalBase-CQji_mgJ.js";import"./index.esm-CLpX3RIH.js";import"./Inputs-cvlDeTHR.js";import"./Buttons-dijALP0_.js";import"./index-DvKACyVh.js";import"./TrashIcon-CpHN25SK.js";import"./UIContext-9PjeG9pu.js";import"./updatesArraysFields-CDmdxi8j.js";import"./index-DG_GJQZz.js";import"./EntityTable-CYBYbV-K.js";import"./updatesSingleRow-C5gkTyzt.js";import"./ClipboardDocumentCheckIcon-C0qHNpyc.js";import"./UserGroupIcon-DFLFYX-R.js";function P({title:d,titleId:n,...c},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":n},c),d?r.createElement("title",{id:n},d):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const k=r.forwardRef(P);function nt({}){return[{title:"Parte Diario"},{name:"description",content:"Parte Diario"}]}const lt=v(function(){var p;const n=M(),{openModal:c}=n.state||{};B();const o=R(),{employees:l}=C(),{selectedProject:m}=D();if(!m)return null;const{phases_project:i}=m,[h,f]=r.useState([]);r.useEffect(()=>{if(!i)return;const s=i.flatMap(a=>a.daily_reports).sort((a,w)=>a.date_report.localeCompare(w.date_report));f(s)},[i]);const j=r.useMemo(()=>new Map(i.map(e=>[e.id,e])),[i]),y=r.useMemo(()=>new Map(l==null?void 0:l.map(e=>[e.id,e.contacto_nombre])),[l]),g=e=>{const s=i.find(a=>a.id===e);return s!=null&&s.id_supervisor?y.get(s.id_supervisor):"No asignado"};return r.useEffect(()=>{c&&o.openModal({type:"new"})},[n]),t.jsxs(t.Fragment,{children:[t.jsxs(_,{title:"",width:"w-full",children:[t.jsx("div",{className:"w-fit -mt-10 mb-4 ms-auto",children:t.jsx(u,{type:"button",variant:"yellow",onClick:()=>o.openModal({type:"new"}),children:"Nuevo Parte Diario"})}),t.jsx("div",{className:"grid xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4",children:h.sort((e,s)=>e.date_report<s.date_report?1:-1).map((e,s)=>{var a;return t.jsxs(b,{children:[t.jsxs("div",{className:"flex gap-2 items-center font-bold text-xl mb-4",children:[t.jsx(k,{className:"size-6 text-primary-text"})," ",t.jsxs("h2",{className:"",children:["PD # ",e.id," ðŸ“…",x(e.date_report)]})]}),t.jsxs("ul",{className:"text-sm space-y-1.5",children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Proyecto:"})," ",m.name]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Fecha:"})," ",x(e.date_report)]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Etapa:"})," ",(a=j.get(e.id_phase))==null?void 0:a.name]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Responsable:"})," ",g(e.id_phase)]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Status:"})," ",t.jsx(N,{variant:e.status==="borrador"?"yellow":"green",children:e.status.slice(0,1).toUpperCase()+e.status.slice(1)})]})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsx(u,{type:"button",size:"sm",variant:"light",onClick:()=>o.openModal({type:"edit",data:e}),children:"Ver detalles"})})]},e.id)})})]}),((p=o.data)==null?void 0:p.type)&&t.jsx(E,{open:o.open,onClose:o.closeModal,type:o.data.type,report:o.data.data})]})});export{lt as default,nt as meta};
